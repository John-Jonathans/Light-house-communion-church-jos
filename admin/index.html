<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel</title>
  </head>
  <body>
    <script>
      try {
        // Look for the raw key you got from the "Green Screen"
        const rawMsg = localStorage.getItem("cms_auth_token");

        if (rawMsg && rawMsg.includes("token")) {
          // Extract the hidden token
          const parts = rawMsg.split("success:");
          if (parts.length > 1) {
            const data = JSON.parse(parts[1]);

            // FORCE-SAVE it exactly where Decap CMS looks for it
            const user = { 
              token: data.token, 
              backendName: 'github',
              name: 'admin'
            };
            localStorage.setItem("netlify-cms-user", JSON.stringify(user));
            console.log("üîê Enforcer: Key restored successfully.");
          }
        }
      } catch (e) {
        console.error("Enforcer Error:", e);
      }
    </script>

    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  </body>
</html>
