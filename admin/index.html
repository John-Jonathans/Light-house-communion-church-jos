<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Panel</title>
  </head>
  <body>
    <script>
      const params = new URLSearchParams(window.location.search);
      const code = params.get("code");

      if (code) {
        document.write("<h1 style='font-family:sans-serif; text-align:center; margin-top:50px;'>ðŸ”„ Completing Login...</h1><p style='text-align:center;'>Redirecting to verification...</p>");
        // Forward the code to the traffic cop manually
        window.location.href = "/api/callback?code=" + code;
      }
    </script>

    <script>
      const tokenMsg = localStorage.getItem("cms_auth_token");
      if (tokenMsg) {
        // If we have a key, give it to the dashboard
        setTimeout(() => {
           window.postMessage(tokenMsg, "*");
        }, 500);
      }
    </script>

    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  </body>
</html>

